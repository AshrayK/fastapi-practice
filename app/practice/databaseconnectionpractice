
import psycopg
from psycopg.rows import dict_row

# Connect to your PostgreSQL database
with psycopg.connect(
    host='localhost',
    dbname='fastapi',
    user='postgres',
    password='admin'
) as conn:

    # Open a cursor to perform database operations
    with conn.cursor(row_factory=dict_row) as cursor:
        # Example query
        cursor.execute("SELECT * FROM your_table")
        rows = cursor.fetchall()
        for row in rows:
            print(row)  # Rows will be dictionaries

        print("Database operations were successful!")



# DATABASE_URL = "host=localhost dbname=fastapi user=postgres password=admin"

# def get_db():
#     try:
#         logging.info("Attempting to connect to the database...")
#         with psycopg.connect(DATABASE_URL, row_factory=dict_row) as conn:
#             logging.info("Database connection was successful.")
#             yield conn
#     except psycopg.Error as e:
#         logging.error("Database connection failed: %s", e)
#         raise HTTPException(status_code=status.HTTP_500_INTERNAL_SERVER_ERROR, detail="Database connection failed")
    
    # try:
    #     conn = pscopg2.connect(host='localhost', database= 'fastapi',
    #                 user= 'postgres' ,
    #     password= 'password1234', cursor_factory=Rea1DictCursor)
    #     curosr=conn. cursor()

    #     print("Database connection was succesfull!")
    # except Exception as error:

    #     print("Connecting to database failed")
    #     print("Error: ",error)
